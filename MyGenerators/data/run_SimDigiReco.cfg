process runAll = {
###############################
#  Example configuration file, to be used with CMSSW_1_0_0
#  Based on tutorial by Freya Blekman, f.blekman@imperial.ac.uk

###############################
# include services
 include "Configuration/ReleaseValidation/data/Services.cfi"


###############################
# initialize  MessageLogger
  include "FWCore/MessageLogger/data/MessageLogger.cfi"


###############################
# make sure you have a random number generator

  service = RandomNumberGeneratorService
  {
    untracked uint32 sourceSeed = 98765
    PSet moduleSeeds =
      {
         untracked uint32 VtxSmeared = 123456789
      }
  }

###############################
#input module:

#include "IOMC/GeneratorInterface/data/PythiaHZZ4mu.cff"
#replace PythiaSource.maxEvents = 20

#include "UserCode/AEverett/MyGenerators/data/source/source_ttbar.cff"
#replace PythiaSource.maxEvents = 20

include "UserCode/AEverett/MyGenerators/data/source/source_single_mu_pt_10_100_negative.cff"
replace  FlatRandomPtGunSource.maxEvents = 10000


###############################
#output module:
 include "Configuration/Examples/data/DropTrackingIntermediateStuff.cff"

 module GEN-SIM-DIGI-RECO = PoolOutputModule {
      untracked string fileName = "reco.root"
      using DropTrackingIntermediateStuff
   }

##############################
# smear the primary vertex (exclude from path if you want vertex at (0,0,0))

include "IOMC/EventVertexGenerators/data/VtxSmearedGauss.cfi"

###############################
# include the 'official' simulation/reconstruction file
# this file contains the path definitions for everything 
# necessary to reconstruct things.

  # L1Extra emulator
  #
  #include "L1Trigger/L1ExtraFromMCTruthProd/data/l1extra-from-mctruth.cff"

  # Simulation and Digitization
  #
  # Geant4-based CMS Detector simulation
  #
  #include "SimG4Core/Application/data/g4SimHits.cfi"
  include "SimG4Core/Application/data/SimG4Object.cfi"

  # This is the full sequence of digitizers 
  # (Pixels, SiStrips, Ecal, Hcal, Muon(CSC,DT,RPC))
  # MixingModule included (in the zero-pileup mode)
  # it "returns" sequence called doAllDigi which can
  # be directly placed in the path
  #
  include "SimG4Core/Application/data/DigiWithEcalZeroSuppression.cff"

  sequence doG4SimHitsDigiEcalZeroSup = { g4SimHits, doAllDigiWithEcalZeroSup}
  
       # Some special sequences defined from stuff in Digi
       #
       sequence doDigi_noCAL = { mix, trDigi & muonDigi }
       sequence doSimDigi_noCAL = { g4SimHits, doDigi_noCAL }


  # Reconstruction
  #
  include "Configuration/Examples/data/RECO.cff"

       # Some special sequences defined from stuff in RECO
       #
       sequence localreco_noCAL = { trackerlocalreco & muonlocalreco }
       sequence globalreco_noCAL = {ckftracks,rstracks,muonreco}
       sequence highlevelreco_noCAL = {
                                offlinePrimaryVerticesFromCTFTracks,
                                offlinePrimaryVerticesFromRSTracks,
                                pixelTracks,
                                pixelVertices,
                                globalMuons
                }
       sequence reconstruction_noCAL = {
                                 localreco_noCAL,
				 globalreco_noCAL,
				 highlevelreco_noCAL
                }

###############################
# now define what you want to do

  #path p = {VtxSmeared, doG4SimHitsDigiEcalZeroSup, reconstruction}
  path p = {VtxSmeared, doSimDigi_noCAL, reconstruction_noCAL}

  endpath outpath = {GEN-SIM-DIGI-RECO}	

}
